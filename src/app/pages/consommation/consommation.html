<!-- dashboard.component.html -->
<div class="container">

  <app-sidebar></app-sidebar>
  <app-navbar></app-navbar>

<div class="dashboard-container">



  <!-- Stats Cards -->
  <div class="stats-grid">
    <app-box
      title="Interventions Urgentes"
      icon="flash.svg"
      [total]=interventionsUrgentes.total
      [percent]=interventionsUrgentes.unit
      color="yellow"
    />

    <app-box
      title="Maintenance Programmée"
      icon="calendar.svg"
      [total]=maintenanceProgrammee.total
      [percent]=maintenanceProgrammee.unit
      color="blue"
    />

    <app-box
      title="Interventions Complétées"
      icon="puzzle.svg"
      [total]="interventionsCompletees.total"
      [percent]="interventionsCompletees.unit"
      color="green"
    />

    <app-box
      title="Temps Moyen de Réparation"
      icon="chart.svg"
      [total]="tempsMoyenReparation.total"
      [percent]="tempsMoyenReparation.unit"
      color="purple"
    />
  </div>

  <!-- Charts Section -->
  <div class="charts-grid">
    <!-- Consommation par Tranche Horaire -->
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#8b5cf6" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2"/>
            <line x1="3" y1="9" x2="21" y2="9"/>
            <line x1="9" y1="21" x2="9" y2="9"/>
          </svg>
        </div>
        <h3 class="chart-title">Consommation par Tranche Horaire</h3>
      </div>

      <div class="bar-chart">
        <div class="y-axis">
          <span class="y-label">160,000</span>
          <span class="y-label">140,000</span>
          <span class="y-label">120,000</span>
          <span class="y-label">100,000</span>
          <span class="y-label">80,000</span>
          <span class="y-label">60,000</span>
          <span class="y-label">40,000</span>
          <span class="y-label">20,000</span>
          <span class="y-label">0</span>
        </div>

        <div class="bars-container">
          <div class="bar-wrapper" *ngFor="let item of consommationData">
            <div class="bar"
                 [style.height.%]="getBarHeight(item.value)"
                 [style.background-color]="item.color">
            </div>
            <span class="bar-label">{{ item.region }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Types de Pannes -->
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#8b5cf6" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
        </div>
        <h3 class="chart-title">Types de Pannes</h3>
      </div>

      <div class="line-chart">
        <svg viewBox="0 0 400 240" class="chart-svg">
          <!-- Grille -->
          <line x1="40" y1="20" x2="40" y2="200" stroke="#e5e7eb" stroke-width="1"/>
          <line x1="40" y1="200" x2="360" y2="200" stroke="#e5e7eb" stroke-width="1"/>

          <!-- Lignes horizontales -->
          <line x1="40" y1="50" x2="360" y2="50" stroke="#f3f4f6" stroke-width="1"/>
          <line x1="40" y1="80" x2="360" y2="80" stroke="#f3f4f6" stroke-width="1"/>
          <line x1="40" y1="110" x2="360" y2="110" stroke="#f3f4f6" stroke-width="1"/>
          <line x1="40" y1="140" x2="360" y2="140" stroke="#f3f4f6" stroke-width="1"/>
          <line x1="40" y1="170" x2="360" y2="170" stroke="#f3f4f6" stroke-width="1"/>

          <!-- Zone remplie -->
          <path
            [attr.d]="svgPath + ' L 360 200 L 40 200 Z'"
            fill="#e9d5ff"
            opacity="0.3"
          />

          <!-- Ligne -->
          <path
            [attr.d]="svgPath"
            fill="none"
            stroke="#8b5cf6"
            stroke-width="2"
          />

          <!-- Labels X -->
          <text *ngFor="let point of pannesData; let i = index"
                [attr.x]="40 + i * 29"
                y="220"
                text-anchor="middle"
                font-size="11"
                fill="#6b7280">
            {{ point.hour }}
          </text>

          <!-- Labels Y -->
          <text x="25" y="205" font-size="11" fill="#6b7280">0</text>
          <text x="25" y="175" font-size="11" fill="#6b7280">10</text>
          <text x="25" y="145" font-size="11" fill="#6b7280">20</text>
          <text x="25" y="115" font-size="11" fill="#6b7280">30</text>
          <text x="25" y="85" font-size="11" fill="#6b7280">40</text>
          <text x="25" y="55" font-size="11" fill="#6b7280">50</text>
          <text x="25" y="25" font-size="11" fill="#6b7280">70</text>
        </svg>
      </div>
    </div>
  </div>
</div>

</div>
